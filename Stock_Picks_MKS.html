<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automated Picks</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<meta charset="UTF-8">
<title>Automated Picks</title>
<style>
    table {
        border-collapse: collapse;
        width: 100%;
    }
    th, td {
        border: 1px solid #dddddd;
        text-align: left;
        padding: 8px;
    }
    th {
        background-color: #383838;
		color: white;
    }
    .positive {
        background-color: green;
        color: white;
    }
    .negative {
        background-color: red;
        color: white;
    }
    .flag-img {
        max-width: 50px;
        max-height: 30px;
    }
    .state-closed {
        background-color: red;
        color: white;
    }
    .state-open {
        background-color: green;
        color: white;
    }
	.state-pre {
        background-color: #e7e700;
        color: white;
    }
</style>
</head>
<body style="background: black;color: white;">

<p style="color: #6c6c6c;">Â© 2024 Development Rights MKS </p>

<div id="avgworldindex">This program incorporate a feature that merges data from the National Stock Exchange (NSE) and the Bombay Stock Exchange (BSE). This amalgamation will be followed by a thorough comparison with the 1-week and 52-week low stock data. Subsequently, the program will filter stocks based on criteria including high open interest, high price, and high volume. This meticulous filtering process aims to provide users with actionable insights into potential investment opportunities, thereby minimizing the need for extensive manual effort in stock selection</div>
</br>

<div style="color: red;">Note: On Mobile Please use <a href="https://play.google.com/store/apps/details?id=com.kiwibrowser.browser&hl=en&gl=US" style="color: yellow;">Kiwi Browser (Link)</a> with extension <a href="https://chromewebstore.google.com/detail/cors-unblock/lfhmikememgdcahcdlaciloancbhjino" style="color: yellow;">CORS Unblock (Link)</a>. Output result takes around more than 5 minutes due to complex & heavy process</div>

</br>

    <table id="dataTable">
        <thead>
            <tr>
			     <th>Industry</th>
                <th>Symbol</th>
				<th>Contract</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be populated here -->
        </tbody>
    </table>



<script>
    $(document).ready(function(){

        // Load jsonData from GitHub URL
        $.getJSON('https://raw.githubusercontent.com/MKS7S/mks7s.github.io/master/symbol_data.json', function(jsonData) {

            function getSymbolNameFromAPI(sName, callback) {
                $.ajax({
                    url: 'https://financialmodelingprep.com/api/v3/search',
                    method: 'GET',
                    crossDomain: true,
                    data: {
                        query: encodeURIComponent(sName),
                        limit: 1,
                        apikey: 'YOUR_API_KEY'
                    },
                    success: function(response){
                        if (response && response.length > 0) {
                            callback(response[0].symbol);
                        } else {
                            callback('');
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error('Failed to fetch symbol name:', error);
                    }
                });
            }

            function getSymbolName(sName, callback) {
                var matchedSymbol = jsonData.find(function(item) {
                    return item.S_NAME === sName;
                });

                if (matchedSymbol && matchedSymbol.Symbol) {
                    var symbol = matchedSymbol.Symbol.replace(/\.NS$|\.BO$/, '');
                    var industry = matchedSymbol.Industry;
                    callback(symbol, industry, sName);
                } else {
                    getSymbolNameFromAPI(sName, function(symbol) {
                        symbol = symbol.replace(/\.NS$|\.BO$/, '');
                        callback(symbol);
                    });
                }
            }

            $.getJSON('https://www.nirmalbang.com/ajaxpages/equity/EquityHighsAndLows.aspx?Exchange=NSE&Type=Low&Period=1WEEK&Group=&Indices=&pageNo=1&PageSize=10000', function(dataNSE){
                $.getJSON('https://www.nirmalbang.com/ajaxpages/equity/EquityHighsAndLows.aspx?Exchange=BSE&Type=Low&Period=1WEEK&Group=&Indices=&pageNo=1&PageSize=10000', function(dataBSE){
                    var mergedData = [];
                    $.merge(mergedData, dataNSE);
                    $.merge(mergedData, dataBSE);

                    var uniqueSymbols = {};
                    var tableBody = $('#dataTable tbody');
                    mergedData.forEach(function(item) {
                        var nseItem = dataNSE.find(x => x.S_NAME === item.S_NAME);
                        var bseItem = dataBSE.find(x => x.S_NAME === item.S_NAME);

                        if (nseItem && bseItem) {
                            getSymbolName(item.S_NAME, function(symbol, industry, sName){
                                if (!uniqueSymbols[sName]) { 
                                    uniqueSymbols[sName] = true;

                                    $.getJSON('https://www.nirmalbang.com/ajaxpages/derivative/DerivOpenInterest.aspx?opt1=IOIIPRIVOL&opt2=&date=&pageNo=1&PageSize=10000', function(openInterestData){
                                        var filteredData = openInterestData.filter(function(oiItem) {
                                            return oiItem.OI_Symbol === symbol;
                                        });

                                        if (filteredData.length > 0) {
                                            var oiItem = filteredData[0];
                                            tableBody.append('<tr>' +
                                                '<td>' + sName + '</td>' + 
                                                '<td>' + symbol + '</td>' +
                                                '<td>' + oiItem.OI_OptType + '</td>' + // Display OI_OptType
                                                '</tr>');
                                        }
                                    });
                                }
                            });
                        }
                    });
                });
            });
        });
    });
</script>





</body>
</html>
